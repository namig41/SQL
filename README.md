# SQL

Лабораторная работа № 1
1. Из файла «Data_for_lab_AM_17_06.xlsx» сделать файлы, соответствующие листам в
электронной таблице. Каждый файл сохранить в текстовом формате «csv».
Разобраться со смыслом данных в таблице.
2. Создать базу данных для работы с помощью утилиты PgAdmin, либо другим
альтернативным вариантом (допускается использование не СУБД PostgreSQL).
3. Создать и запустить запрос на создание таблиц в базе дынных, содержащихся в
файлах «csv». Первичные и внешние ключи не создавать.
4. Создать и запустить запрос на импортирование данных из «csv» файлов в таблицы
базы данных.
5. Посмотреть описание оператора «ALTER TABLE». Создать и запустить запрос на
создание первичных и внешних ключей и дополнительных ограничений в таблицах.
Продумать логически режимы на изменение и удаление данных связанных с
ключами.

Лабораторная работа № 2
По данным из первой лабораторной работы реализовать следующие запросы:
1. Вывести всю информацию о станциях, id которых начинаются и
заканчиваются одной и той же цифрой.
2. Вывести информацию о станциях (id, название), название которых состоят
из не менее 8 символов (включая пробелы и дефисы между составными
названиями) и содержат не менее двух букв «о».
3. Из таблицы «dislocation» вывести следующие данные: ид станции, тип
вагона, время ожидания. Не должно быть одинаковых строк в результате.
Результат отсортировать по убыванию времени ожидания.
4. Вывести всю информацию о любых семи разных маршрутах со станции
«Бирюсинск», стоимостью не менее 7000.
5. Из таблицы «orders» вывести: id заявки, доход от вагона, число вагонов,
суммарный доход, время разгрузки, если число вагонов от 20 до 30, или 71,
или 20.
6. Вывести id заявок, для которых неизвестна обязательность выполнения.
7. Проверить, есть ли в таблице «stations» ячейки, в которых отсутствует
значение.
8. Удалить из таблицы «dislocation» кортеж, для которого id расположения
равен 666. Вставить в таблицу dislocation данные (id расположения
пропущен, сделать чтобы ид расположения добавлялся автоматически):
(971201,0,1,1,1,7), (921202,2,1,1,1,6), (843408,1,1,1,1,6), (843408,1,1,1,1,6).
Создать в базе таблицу «пустые вагоны» со следующими атрибутами:
количество вагонов, тип вагона, время ожидания, период, id станции.
Заполнить ее, исходя из исходных данных в базе (таблица «dislocation»).
Предложить способы проверки (и проверить) на наличие одинаковых
комбинаций значение составного атрибута: тип вагона, период, id станции.
9. Для станций с ненулевым минимальным количеством вагонов увеличить
стоимость простоя на 20 процентов.

Лабораторная работа № 3
1. Вывести названия станции с минимальной и максимальной ценой простоя с указанием
цены.
2. Для каждого id станции, с минимум двумя нулями в id, вывести период, среднее по
периоду количество загруженных вагонов, среднее по периоду количество незагруженных
вагонов и их сумму (таблица «dislocation»). Вывод отсортировать по убыванию периода.
Столбец с суммой не должен содержать нулей.
3. Для каждого периода вывести количество различных станций, соответствующих
периоду, среднее по периоду число вагонов, при условии, что среднее по периоду число
вагонов отличается от максимального среднего по периоду числа вагонов не более, чем на
5 (таблица «dislocation»).
4. Вывести названия станций, которые не встречаются в начальном пункте отправления
заявок.
5. Вывести названия станция из конечных пунктов заявок, для которых все заявки имеют
стоимость более 7700.
6. Вывести объединенное имя стаций всех заявок (например, «Станция1_to_Станция_2»),
для которых в расписании найдется период с количеством вагонов из интервала от 29 до
7. Создайте таблицу с числом строк более 1000000 и продемонстрируйте, что доступ к
индексированным полям осуществляется быстрее, нежели к неиндексированным. У
таблицы должен быть первичный ключ.